--- a/orthoroute/algorithms/manhattan/pathfinder/cuda_dijkstra.py
+++ b/orthoroute/algorithms/manhattan/pathfinder/cuda_dijkstra.py
@@ -290,6 +290,7 @@ class CUDADijkstra:
             const int* goal_coords,             // (K, 3) goal coordinates (gx, gy, gz) per ROI
             const int use_astar,                // A* enable flag
             float* dist,                        // (K, max_roi_size) distances
+            const int dist_stride,              // Stride for dist array indexing
             int* parent,                        // (K, max_roi_size) parents
             unsigned int* new_frontier,         // (K, frontier_words) BIT-PACKED output
             // Phase 4: ROI bounding boxes
@@ -313,7 +314,8 @@ class CUDADijkstra:
             const int indices_off = roi_idx * indices_stride;
             const int weights_off = roi_idx * weights_stride;
             const int total_cost_off = roi_idx * total_cost_stride; // PathFinder negotiated costs
-            const int dist_off = roi_idx * max_roi_size;
+            const size_t dist_off = (size_t)roi_idx * (size_t)dist_stride;
             const int frontier_off = roi_idx * frontier_words;

             // Guarded atomic: Check distance before edge expansion
